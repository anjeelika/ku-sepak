{% extends 'base.html' %}
{% load static %}

{% block meta %}
<title>KuSepak!</title>
{% endblock meta %}

{% block content %}
{% include 'navbar.html' %}
<div class="bg-gray-50 w-full pt-16 min-h-screen">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <!-- Filter Section -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8 bg-white rounded-lg border border-gray-200 p-4">
      <div class="flex space-x-3 mb-4 sm:mb-0">
        <button id="filter-all"
          class="px-4 py-2 rounded-md font-medium transition-colors bg-[#be7919] text-white hover:bg-[#a45b19]">
          All Products
        </button>
        <button id="filter-my"
          class="px-4 py-2 rounded-md font-medium transition-colors bg-white text-gray-700 border border-gray-300 hover:bg-[#be7919] hover:text-white">
          My Products
        </button>
      </div>
      {% if user.is_authenticated %}
      <div class="flex items-center space-x-3">
        <button id="btn-refresh"
          class="px-4 py-2 bg-[#be7919] text-white rounded-md hover:bg-[#a45b19] transition-colors">
          Refresh
        </button>
        <div class="text-sm text-gray-500">
          Last login: {{ last_login }}
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Button Create Product -->
    {% if user.is_authenticated %}
    <div class="flex justify-end mb-6">
      <button id="btn-create"
        class="px-4 py-2 bg-[#be7919] text-white rounded-md hover:bg-[#a45b19] transition-colors">
        + Add Product
      </button>
    </div>
    {% endif %}

    <!-- Product Container (AJAX rendered) -->
    <div id="product-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- JS will render cards here -->
    </div>

    <!-- Loading, Empty, and Error States -->
    <div id="loading-state" class="hidden text-center py-12 text-gray-500">Loading products...</div>
    <div id="empty-state" class="hidden text-center py-12 text-gray-500">
      <img src="{% static 'image/no-products.png' %}" alt="No products" class="w-32 h-32 mx-auto mb-3">
      <p>No products found.</p>
    </div>
    <div id="error-state" class="hidden text-center py-12 text-red-500">Failed to load products. Please try again.</div>

  </div>
</div>

<!-- Modal: Create/Edit Product -->
<div id="modal-product" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
  <div class="bg-white rounded-lg w-11/12 sm:w-2/3 lg:w-1/2 p-6 relative">
    <h2 id="modal-title" class="text-xl font-semibold mb-4">Create Product</h2>
    <form id="form-product" class="space-y-4">
      <input type="hidden" id="product-id">
      <div>
        <label class="block text-sm font-medium">Name</label>
        <input id="product-name" type="text" class="w-full border-gray-300 rounded-md">
      </div>
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium">Price</label>
          <input id="product-price" type="number" min="0" class="w-full border-gray-300 rounded-md">
        </div>
        <div>
          <label class="block text-sm font-medium">Stock</label>
          <input id="product-stock" type="number" min="0" class="w-full border-gray-300 rounded-md">
        </div>
      </div>
      <div>
        <label class="block text-sm font-medium">Description</label>
        <textarea id="product-description" class="w-full border-gray-300 rounded-md"></textarea>
      </div>
      <div>
        <label class="block text-sm font-medium">Thumbnail URL</label>
        <input id="product-thumbnail" type="url" class="w-full border-gray-300 rounded-md">
      </div>
      <div>
        <label class="block text-sm font-medium">Category</label>
        <select id="product-category" class="w-full border-gray-300 rounded-md">
          <option value="ball">Ball</option>
          <option value="shoes">Shoes</option>
          <option value="jersey">Jersey & Apparel</option>
          <option value="accessories">Accessories</option>
          <option value="bag">Bags</option>
        </select>
      </div>
      <div class="flex items-center">
        <input id="product-featured" type="checkbox" class="mr-2">
        <label for="product-featured" class="text-sm">Featured product</label>
      </div>

      <div class="flex justify-end space-x-3 mt-6">
        <button type="button" id="btn-cancel"
          class="px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-100">Cancel</button>
        <button type="submit"
          class="px-4 py-2 bg-[#be7919] text-white rounded-md hover:bg-[#a45b19] transition-colors">
          Save
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal: Delete Confirmation -->
<div id="modal-delete" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
  <div class="bg-white rounded-lg w-96 p-6 text-center">
    <h3 class="text-lg font-semibold mb-4">Are you sure you want to delete this product?</h3>
    <div class="flex justify-center space-x-4">
      <button id="btn-delete-cancel" class="px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-100">
        Cancel
      </button>
      <button id="btn-delete-confirm"
        class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors">
        Delete
      </button>
    </div>
  </div>
</div>

{% endblock content %}